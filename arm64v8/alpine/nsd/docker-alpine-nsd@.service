[Unit]
Description=Containerized Alpine NSD name server at LAN IP %i

Requires=docker.service
Requires=docker-alpine-nsd-build@%i.service

After=docker.service
After=docker-alpine-nsd-build@%i.service

[Service]
Type=simple

TimeoutStartSec=0

KillMode=none

EnvironmentFile=/etc/environment

ExecStartPre=/usr/bin/docker create \
    --name nsd \
    -p %i:53:53/tcp \
    -p %i:53:53/udp \
    yuanmodu/arm64v8-alpine-nsd
ExecStart=/usr/bin/docker start -a nsd

ExecStop=/usr/bin/docker stop nsd
ExecStopPost=/usr/bin/docker rm nsd

[Install]
WantedBy=multi-user.target
